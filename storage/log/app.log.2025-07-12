[2025-07-12 00:09:16,625.625] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:09:16,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:09:16,625.625] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.3s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:09:16,629.629] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-07-12 00:09:16,630.630] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:09:16,637.637] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.content, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-07-12 00:09:16,637.637] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.8s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'node_id': UUID('3f648d9e-3155-44f0-9859-a8607ee37a6b'), 'position': 15, 'character_count': 169, 'token_count': 142, 'keywords': '[]', 'hash': '3aa609b07fdd7f24839a3f9395f594e6727e57e2df6f755d6c05aa910ab18afb', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 7, 12, 0, 9, 16, 635883), 'indexing_completed_at': datetime.datetime(2025, 7, 12, 0, 9, 16, 635892), 'completed_at': datetime.datetime(2025, 7, 12, 0, 9, 16, 635893), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-07-12 00:09:16,639.639] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:09:16,640.640] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:09:16,640.640] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:09:16,640.640] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.7s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:09:16,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:09:16,642.642] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.7s ago] {'pk_1': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4')}
[2025-07-12 00:09:17,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-07-12 00:09:17,709.709] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.5s ago] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'param_1': 1}
[2025-07-12 00:09:17,717.717] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-07-12 00:09:17,717.717] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.5s ago] {'character_count': 1389, 'token_count': 1391, 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:09:17,719.719] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:09:17,723.723] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:09:17,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:09:17,724.724] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.8s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:09:17,727.727] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:09:17,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.8s ago] {'pk_1': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4')}
[2025-07-12 00:09:17,733.733] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-12 00:09:17,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.5s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-12 00:09:17,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-07-12 00:09:17,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.5s ago] {'id_1_1': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4')}
[2025-07-12 00:09:17,765.765] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-12 00:09:17,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.5s ago] {'keyword_table': '{"XX": ["d1f48596-170f-4e42-a045-80cc8d4aa6fb", "395934c6-3fce-4df6-9b01-7e2ee1e659c2", "68a186d9-d544-4c55-9bf0-65b0b858c102", "e8a635fc-e579-4be8-8 ... (21502 characters truncated) ... fc5-49fa-addb-792196cc1c82", "5196109e-497c-453a-9eb9-6ecb9f4092cb", "cead90d6-555a-4566-a2bf-5d74036c650d", "cf6f47d9-2c09-4115-9df9-625f51543688"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-12 00:09:17,769.769] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:09:17,771.771] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [12/Jul/2025 00:09:17] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments HTTP/1.1" 200 -
[2025-07-12 00:15:02,605.605] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-07-12 00:15:03,010.010] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:15:05,802.802] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:15:05,850.850] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:15:22,528.528] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-07-12 00:15:22,832.832] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:15:25,413.413] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:15:25,463.463] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:15:32,910.910] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-12 00:15:32,911.911] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:15:32,912.912] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-12 00:15:32,912.912] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:15:32,912.912] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-12 00:15:32,912.912] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:15:32,913.913] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:15:32,915.915] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:15:32,915.915] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:15:32,920.920] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-07-12 00:15:32,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'coalesce_2': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:15:32,922.922] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-12 00:15:32,922.922] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-12 00:15:33,368.368] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.446 seconds.
[2025-07-12 00:15:33,368.368] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-12 00:15:33,371.371] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.content, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-07-12 00:15:33,371.371] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00020s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'node_id': UUID('5cb66612-b4cd-4fc5-ae88-d9c3a8897bc3'), 'position': 16, 'character_count': 169, 'token_count': 142, 'keywords': '[]', 'hash': '3aa609b07fdd7f24839a3f9395f594e6727e57e2df6f755d6c05aa910ab18afb', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 7, 12, 0, 15, 33, 369745), 'indexing_completed_at': datetime.datetime(2025, 7, 12, 0, 15, 33, 369747), 'completed_at': datetime.datetime(2025, 7, 12, 0, 15, 33, 369748), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-07-12 00:15:33,377.377] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:15:33,378.378] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:15:33,378.378] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:15:33,378.378] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00010s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:15:33,380.380] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:15:33,381.381] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099')}
[2025-07-12 00:15:34,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-07-12 00:15:34,457.457] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'param_1': 1}
[2025-07-12 00:15:34,461.461] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-07-12 00:15:34,461.461] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'character_count': 1558, 'token_count': 1533, 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:15:34,462.462] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:15:34,463.463] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:15:34,463.463] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:15:34,463.463] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.085s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:15:34,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:15:34,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.084s ago] {'pk_1': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099')}
[2025-07-12 00:15:34,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-12 00:15:34,466.466] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-12 00:15:34,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-07-12 00:15:34,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'id_1_1': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099')}
[2025-07-12 00:15:34,470.470] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-12 00:15:34,470.470] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'keyword_table': '{"XX": ["58546977-3115-447e-9253-69bb5da273c8", "769fbff9-a6a2-4c09-949d-5579454e7eae", "5208149b-39bb-4bc2-9b54-039e48024709", "d1f48596-170f-4e42-a ... (21502 characters truncated) ... e64-4b53-b5d4-77561e7d9bd2", "3490d612-6fc5-49fa-addb-792196cc1c82", "cead90d6-555a-4566-a2bf-5d74036c650d", "5196109e-497c-453a-9eb9-6ecb9f4092cb"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-12 00:15:34,474.474] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:15:34,475.475] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [12/Jul/2025 00:15:34] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments HTTP/1.1" 200 -
[2025-07-12 00:16:30,915.915] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-07-12 00:16:31,245.245] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:16:33,805.805] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:16:33,819.819] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:17:15,578.578] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-07-12 00:17:15,906.906] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:17:18,602.602] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:17:18,616.616] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:17:18,935.935] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-12 00:17:18,935.935] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:17:18,935.935] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-12 00:17:18,936.936] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:17:18,936.936] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-12 00:17:18,936.936] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:17:18,937.937] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:17:18,939.939] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:17:18,939.939] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:17:18,942.942] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-07-12 00:17:18,942.942] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'coalesce_2': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:17:18,943.943] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-12 00:17:18,944.944] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-12 00:17:19,374.374] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.430 seconds.
[2025-07-12 00:17:19,374.374] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-12 00:17:19,377.377] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-07-12 00:17:19,377.377] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'node_id': UUID('de38c676-a729-4bf3-8e89-f718177628fb'), 'position': 17, 'content': '该接口主要用于在指定文档下新增 文档片段 信息，添加的片段位置会处于该文档的最后，并且由于每次只能新增一个文档片段，相对来说并不会这么耗时（无需加载分割，直接并行执行 关键词提取+文本转向量），所以该接口是同步的，接口会等待处理完毕后再返回，该接口如果任意一个 dataset_id 或 document_id 出错，都会抛出对应的错误。', 'character_count': 169, 'token_count': 142, 'keywords': '[]', 'hash': '3aa609b07fdd7f24839a3f9395f594e6727e57e2df6f755d6c05aa910ab18afb', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 7, 12, 0, 17, 19, 375326), 'indexing_completed_at': datetime.datetime(2025, 7, 12, 0, 17, 19, 375329), 'completed_at': datetime.datetime(2025, 7, 12, 0, 17, 19, 375330), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-07-12 00:17:19,381.381] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:17:19,382.382] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:17:19,383.383] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:17:19,383.383] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:17:19,385.385] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:17:19,386.386] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'pk_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8')}
[2025-07-12 00:17:20,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-07-12 00:17:20,457.457] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00085s] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'param_1': 1}
[2025-07-12 00:17:20,465.465] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-07-12 00:17:20,465.465] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'character_count': 1727, 'token_count': 1675, 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:17:20,467.467] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:17:20,469.469] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:17:20,469.469] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:17:20,469.469] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.086s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:17:20,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:17:20,471.471] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.086s ago] {'pk_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8')}
[2025-07-12 00:17:20,474.474] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-12 00:17:20,475.475] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-12 00:17:20,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-07-12 00:17:20,480.480] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'id_1_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8')}
[2025-07-12 00:17:20,484.484] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-12 00:17:20,484.484] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'keyword_table': '{"XX": ["db62dda1-11d7-4e4e-8f3e-92eb762b3040", "3327f6a8-67b9-47bc-9a22-cea27af0fa29", "1603ab62-31b5-489e-b93a-8e23a76e9b33", "d1f48596-170f-4e42-a ... (21502 characters truncated) ... fc5-49fa-addb-792196cc1c82", "1994e4e2-0be8-4c83-a14a-6effe48bd54c", "cf6f47d9-2c09-4115-9df9-625f51543688", "5196109e-497c-453a-9eb9-6ecb9f4092cb"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-12 00:17:20,490.490] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:17:20,492.492] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [12/Jul/2025 00:17:20] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments HTTP/1.1" 200 -
[2025-07-12 00:24:36,297.297] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/segment_service.py', reloading
[2025-07-12 00:24:36,673.673] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:24:48,008.008] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:24:50,436.436] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:24:50,450.450] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:24:54,426.426] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-12 00:24:54,426.426] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:24:54,427.427] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-12 00:24:54,427.427] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:24:54,427.427] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-12 00:24:54,427.427] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:24:54,428.428] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:24:54,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:24:54,431.431] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:24:54,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-07-12 00:24:54,435.435] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'coalesce_2': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:24:54,437.437] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-12 00:24:54,437.437] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-12 00:24:54,879.879] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.442 seconds.
[2025-07-12 00:24:54,879.879] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-12 00:24:54,882.882] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-07-12 00:24:54,882.882] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'node_id': UUID('1a079aa8-b7ac-4d37-8458-f63d5a39e1b8'), 'position': 18, 'content': '该接口主要用于在指定文档下新增 文档片段 信息，添加的片段位置会处于该文档的最后，并且由于每次只能新增一个文档片段，相对来说并不会这么耗时（无需加载分割，直接并行执行 关键词提取+文本转向量），所以该接口是同步的，接口会等待处理完毕后再返回，该接口如果任意一个 dataset_id 或 document_id 出错，都会抛出对应的错误。', 'character_count': 169, 'token_count': 142, 'keywords': '["\\u6587\\u6863", "\\u63a5\\u53e3", "\\u7247\\u6bb5", "id", "\\u5e76\\u884c\\u6267\\u884c", "\\u65b0\\u589e", "dataset", "document", "\\u5904\\u7406\\u5b8c\\u6bd5", "\\u52a0\\u8f7d"]', 'hash': '3aa609b07fdd7f24839a3f9395f594e6727e57e2df6f755d6c05aa910ab18afb', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 7, 12, 0, 24, 54, 880376), 'indexing_completed_at': datetime.datetime(2025, 7, 12, 0, 24, 54, 880381), 'completed_at': datetime.datetime(2025, 7, 12, 0, 24, 54, 880381), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-07-12 00:24:54,888.888] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:24:54,889.889] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:24:54,890.890] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:24:54,890.890] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:24:54,894.894] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:24:54,894.894] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-12 00:24:55,975.975] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-07-12 00:24:55,975.975] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'param_1': 1}
[2025-07-12 00:24:55,979.979] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-07-12 00:24:55,979.979] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'character_count': 1896, 'token_count': 1817, 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:24:55,980.980] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:24:55,985.985] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:24:55,985.985] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-12 00:24:55,986.986] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.095s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-12 00:24:55,987.987] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:24:55,987.987] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.093s ago] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-12 00:24:55,989.989] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-12 00:24:55,990.990] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-12 00:24:55,993.993] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-07-12 00:24:55,993.993] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'id_1_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-12 00:24:55,995.995] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-12 00:24:55,996.996] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'keyword_table': '{"XX": ["c08e01b4-73f9-4562-a5fe-dbe2630e134d", "ad9809d0-d45e-4d68-963d-34239db30b97", "d1f48596-170f-4e42-a045-80cc8d4aa6fb", "69cd0f1f-8764-4bf3-b ... (22105 characters truncated) ... a7a56cf6fee5"], "\\u5904\\u7406\\u5b8c\\u6bd5": ["d5fed778-2d8f-4f31-bf63-a7a56cf6fee5"], "\\u52a0\\u8f7d": ["d5fed778-2d8f-4f31-bf63-a7a56cf6fee5"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-12 00:24:55,999.999] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-12 00:24:56,001.001] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [12/Jul/2025 00:24:56] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments HTTP/1.1" 200 -
[2025-07-12 00:47:54,637.637] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-07-12 00:47:54,637.637] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-07-12 00:47:54,638.638] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-12 00:47:56,994.994] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-12 00:47:57,043.043] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-12 00:47:59,005.005] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-12 00:47:59,005.005] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:47:59,006.006] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-12 00:47:59,007.007] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:47:59,007.007] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-12 00:47:59,007.007] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-12 00:47:59,008.008] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-12 00:47:59,011.011] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-12 00:47:59,011.011] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-12 00:47:59,016.016] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-12 00:47:59,016.016] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [12/Jul/2025 00:47:59] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments/d5fed778-2d8f-4f31-bf63-a7a56cf6fee5 HTTP/1.1" 200 -
