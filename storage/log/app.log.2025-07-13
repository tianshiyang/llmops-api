[2025-07-13 17:19:57,088.088] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-07-13 17:19:57,089.089] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-07-13 17:19:57,090.090] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-13 17:19:59,631.631] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-13 17:19:59,660.660] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 222-154-992
[2025-07-13 17:22:41,729.729] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-13 17:22:41,729.729] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-13 17:22:41,730.730] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-13 17:22:41,730.730] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-13 17:22:41,731.731] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-13 17:22:41,731.731] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-13 17:22:41,732.732] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-13 17:22:41,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,734.734] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,872.872] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET content=%(content)s, character_count=%(character_count)s, token_count=%(token_count)s, keywords=%(keywords)s::JSONB, hash=%(hash)s WHERE segment.id = %(segment_id)s::UUID
[2025-07-13 17:22:41,872.872] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'content': '文本，是指书面语言的表现形式，从文学角度说，通常是具有完整、系统含义（Message）的一个句子或多个句子的组合。一个文本可以是一个句子（Sentence）、一个段落（Paragraph）或者一个篇章（Discourse）。广义“文本”：任何由书写所固定下来的任何话语。（利科尔） 狭义“文本”：由语言文字组成的文学实体，代指“作品”，相对于作者、世界构成一个独立、自足的系统。', 'character_count': 189, 'token_count': 157, 'keywords': '["[\\"1\\", \\"2\\",  \\"3\\"]"]', 'hash': 'f8f85bd660a14bb6511b848cd134e107157c6a4d00f2151e00f0a6748126ac33', 'segment_id': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,875.875] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-13 17:22:41,876.876] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-13 17:22:41,877.877] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,877.877] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,881.881] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-13 17:22:41,882.882] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00123s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-13 17:22:41,887.887] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-13 17:22:41,887.887] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'keyword_table': '{"XX": ["c08e01b4-73f9-4562-a5fe-dbe2630e134d", "ad9809d0-d45e-4d68-963d-34239db30b97", "d1f48596-170f-4e42-a045-80cc8d4aa6fb", "69cd0f1f-8764-4bf3-b ... (21502 characters truncated) ... fc5-49fa-addb-792196cc1c82", "cead90d6-555a-4566-a2bf-5d74036c650d", "5196109e-497c-453a-9eb9-6ecb9f4092cb", "cf6f47d9-2c09-4115-9df9-625f51543688"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-13 17:22:41,891.891] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-13 17:22:41,893.893] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-13 17:22:41,893.893] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,893.893] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01621s ago] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,894.894] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-07-13 17:22:41,894.894] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01329s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-13 17:22:41,897.897] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-07-13 17:22:41,897.897] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'id_1_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,898.898] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-07-13 17:22:41,898.898] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01107s ago] {'keyword_table': '{"XX": ["e6a66ca4-5c7f-468e-b232-13e326fecb43", "2660a8c8-c0f2-45d7-93c2-b9767291e307", "395934c6-3fce-4df6-9b01-7e2ee1e659c2", "1603ab62-31b5-489e-b ... (21576 characters truncated) ... 109e-497c-453a-9eb9-6ecb9f4092cb", "cf6f47d9-2c09-4115-9df9-625f51543688"], "[\\"1\\", \\"2\\",  \\"3\\"]": ["d5fed778-2d8f-4f31-bf63-a7a56cf6fee5"]}', 'keyword_table_id': UUID('3b6aa958-2cff-40e0-9512-9c469e17cd5b')}
[2025-07-13 17:22:41,900.900] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-13 17:22:41,903.903] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-13 17:22:41,903.903] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,903.903] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02603s ago] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:41,908.908] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,908.908] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-13 17:22:41,914.914] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-07-13 17:22:41,914.914] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('89e077db-e708-4084-83ef-57e502d51987'), 'param_1': 1}
[2025-07-13 17:22:41,928.928] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-07-13 17:22:41,928.928] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'character_count': 1916, 'token_count': 1832, 'document_id': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-13 17:22:41,930.930] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-13 17:22:41,932.932] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-13 17:22:41,932.932] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-07-13 17:22:41,932.932] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05518s ago] {'pk_1': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5')}
[2025-07-13 17:22:42,245.245] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-13 17:22:42,246.246] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [13/Jul/2025 17:22:42] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/89e077db-e708-4084-83ef-57e502d51987/segments/d5fed778-2d8f-4f31-bf63-a7a56cf6fee5 HTTP/1.1" 200 -
