[2025-07-17 22:49:38,414.414] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-07-17 22:49:38,415.415] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-07-17 22:49:38,416.416] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:49:40,860.860] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:49:40,875.875] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:53:12,770.770] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 89, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:53:12,773.773] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:53:12] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:54:04,436.436] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 89, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:54:04,437.437] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:54:04] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:54:10,537.537] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 89, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:54:10,538.538] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:54:10] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:54:27,087.087] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 22:54:27,087.087] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:54:27,088.088] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 22:54:27,088.088] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:54:27,113.113] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 22:54:27,113.113] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:54:27,114.114] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 22:54:27,116.116] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 22:54:27,117.117] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 22:54:27,131.131] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 22:54:27,131.131] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 22:54:27,138.138] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 91, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 52, in search_in_datasets
    from internal.core.retrievers import SemanticRetriever, FullTextRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/__init__.py", line 9, in <module>
    from .semantic_retriever import SemanticRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 18, in <module>
    class SemanticRetriever(BaseRetriever):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 112, in __new__
    private_attributes = inspect_namespace(
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 459, in inspect_namespace
    raise PydanticUserError(
pydantic.errors.PydanticUserError: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
[2025-07-17 22:54:27,140.140] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 22:54:27,149.149] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:54:27] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 22:54:35,315.315] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 89, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:54:35,317.317] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:54:35] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:55:03,073.073] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-07-17 22:55:03,431.431] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:55:06,284.284] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:55:06,300.300] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:55:06,448.448] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 22:55:06,450.450] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:55:06,454.454] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 22:55:06,454.454] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:55:06,463.463] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 22:55:06,464.464] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 22:55:06,465.465] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 22:55:06,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 22:55:06,471.471] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 22:55:06,485.485] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 22:55:06,486.486] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 22:55:06,490.490] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 91, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 52, in search_in_datasets
    from internal.core.retrievers import SemanticRetriever, FullTextRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/__init__.py", line 9, in <module>
    from .semantic_retriever import SemanticRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 18, in <module>
    class SemanticRetriever(BaseRetriever):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 112, in __new__
    private_attributes = inspect_namespace(
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 459, in inspect_namespace
    raise PydanticUserError(
pydantic.errors.PydanticUserError: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
[2025-07-17 22:55:06,493.493] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 22:55:06,523.523] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:55:06] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 22:55:13,722.722] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-07-17 22:55:14,046.046] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:55:17,004.004] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:55:17,018.018] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:55:39,916.916] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 22:55:40,267.267] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:55:42,997.997] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:55:43,010.010] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:55:48,872.872] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:55:48,876.876] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:55:48] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:56:24,041.041] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 22:56:24,379.379] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:56:27,267.267] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:56:27,281.281] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:56:27,326.326] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:56:27,347.347] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:56:27] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:57:20,196.196] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 22:57:20,549.549] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:57:23,296.296] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:57:23,312.312] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:57:29,561.561] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 415 Unsupported Media Type: Did not attempt to load JSON data because the request Content-Type was not 'application/json'.
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 87, in hit
    print(request.get_json())
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/wrappers/request.py", line 604, in get_json
    return self.on_json_loading_failed(None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/wrappers.py", line 214, in on_json_loading_failed
    return super().on_json_loading_failed(e)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/wrappers/request.py", line 647, in on_json_loading_failed
    raise UnsupportedMediaType(
werkzeug.exceptions.UnsupportedMediaType: 415 Unsupported Media Type: Did not attempt to load JSON data because the request Content-Type was not 'application/json'.
[2025-07-17 22:57:29,587.587] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:57:29] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 22:57:37,502.502] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 415 Unsupported Media Type: Did not attempt to load JSON data because the request Content-Type was not 'application/json'.
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 87, in hit
    print(request.get_json())
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/wrappers/request.py", line 604, in get_json
    return self.on_json_loading_failed(None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/wrappers.py", line 214, in on_json_loading_failed
    return super().on_json_loading_failed(e)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/wrappers/request.py", line 647, in on_json_loading_failed
    raise UnsupportedMediaType(
werkzeug.exceptions.UnsupportedMediaType: 415 Unsupported Media Type: Did not attempt to load JSON data because the request Content-Type was not 'application/json'.
[2025-07-17 22:57:37,525.525] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:57:37] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 22:58:02,578.578] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 22:58:02,917.917] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:58:05,712.712] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:58:05,746.746] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:58:07,682.682] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    raise ValidateErrorException(req.errors)
internal.exception.exception.ValidateErrorException
[2025-07-17 22:58:07,688.688] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:58:07] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 22:59:02,601.601] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 22:59:02,930.930] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:59:05,840.840] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:59:05,855.855] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:59:09,517.517] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: name 'validate_error_json' is not defined
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    raise validate_error_json(req.errors)
NameError: name 'validate_error_json' is not defined
[2025-07-17 22:59:09,547.547] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:59:09] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 22:59:36,998.998] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-07-17 22:59:36,998.998] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-07-17 22:59:37,000.000] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 22:59:39,597.597] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 22:59:39,609.609] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 22:59:57,017.017] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: exceptions must derive from BaseException
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    raise validate_error_json(req.errors)
TypeError: exceptions must derive from BaseException
[2025-07-17 22:59:57,032.032] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 22:59:57] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:00:19,960.960] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 23:00:20,368.368] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:00:23,263.263] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:00:23,279.279] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:00:25,245.245] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:00:25] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:00:44,321.321] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py', reloading
[2025-07-17 23:00:44,664.664] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:00:47,378.378] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:00:47,400.400] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:02:11,165.165] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/schema/dataset_schema.py', reloading
[2025-07-17 23:02:11,499.499] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:02:14,394.394] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:02:14,432.432] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:02:14,913.913] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:02:14,913.913] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:02:14,914.914] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:02:14,914.914] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:02:14,915.915] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:02:14,915.915] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:02:14,915.915] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:02:14,917.917] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:02:14,917.917] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:02:14,920.920] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:02:14,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:02:14,924.924] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 52, in search_in_datasets
    from internal.core.retrievers import SemanticRetriever, FullTextRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/__init__.py", line 9, in <module>
    from .semantic_retriever import SemanticRetriever
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 18, in <module>
    class SemanticRetriever(BaseRetriever):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 112, in __new__
    private_attributes = inspect_namespace(
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/pydantic/_internal/_model_construction.py", line 459, in inspect_namespace
    raise PydanticUserError(
pydantic.errors.PydanticUserError: A non-annotated attribute was detected: `dataset_ids = list[uuid.UUID]`. All model fields require a type annotation; if `dataset_ids` is not meant to be a field, you may be able to resolve this error by annotating it as a `ClassVar` or updating `model_config['ignored_types']`.

For further information visit https://errors.pydantic.dev/2.11/u/model-field-missing-annotation
[2025-07-17 23:02:14,927.927] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:02:14,934.934] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:02:14] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:04:20,350.350] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:04:20,693.693] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:04:23,495.495] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:04:23,512.512] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:04:26,755.755] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:04:26,755.755] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:04:26,756.756] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:04:26,756.756] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:04:26,756.756] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:04:26,756.756] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:04:26,757.757] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:04:26,759.759] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:04:26,759.759] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:04:26,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:04:26,764.764] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:04:26,840.840] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: langchain_core.vectorstores.base.VectorStore.similarity_search_with_relevance_scores() got multiple values for keyword argument 'k'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 77, in search_in_datasets
    lc_documents = semantic_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 30, in _get_relevant_documents
    search_result = self.vector_store.similarity_search_with_relevance_scores(
TypeError: langchain_core.vectorstores.base.VectorStore.similarity_search_with_relevance_scores() got multiple values for keyword argument 'k'
[2025-07-17 23:04:26,842.842] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:04:26,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:04:26] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:08:01,834.834] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:08:02,195.195] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:08:05,115.115] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:08:05,132.132] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:08:05,305.305] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:08:05,305.305] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:05,308.308] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:08:05,310.310] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:05,313.313] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:08:05,313.313] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:05,315.315] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:08:05,322.322] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:08:05,323.323] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00091s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:08:05,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:08:05,351.351] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:08:05,642.642] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 'tuple' object has no attribute 'metadata'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 84, in search_in_datasets
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 84, in <genexpr>
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
AttributeError: 'tuple' object has no attribute 'metadata'
[2025-07-17 23:08:05,645.645] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:08:05,652.652] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:08:05] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:08:30,510.510] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py', reloading
[2025-07-17 23:08:30,843.843] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:08:33,529.529] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:08:33,547.547] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:08:35,456.456] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:08:35,456.456] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:35,457.457] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:08:35,457.457] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:35,459.459] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:08:35,459.459] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:08:35,460.460] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:08:35,461.461] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:08:35,461.461] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:08:35,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:08:35,464.464] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:08:35,715.715] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 'tuple' object has no attribute 'metadata'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 85, in search_in_datasets
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 85, in <genexpr>
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
AttributeError: 'tuple' object has no attribute 'metadata'
[2025-07-17 23:08:35,718.718] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:08:35,727.727] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:08:35] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:13:56,480.480] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py', reloading
[2025-07-17 23:13:56,863.863] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:13:59,783.783] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:13:59,797.797] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:14:01,953.953] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:14:01,954.954] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:14:01,958.958] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:14:01,958.958] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:14:01,959.959] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:14:01,959.959] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:14:01,960.960] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:14:01,964.964] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:14:01,964.964] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:14:01,968.968] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:14:01,969.969] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:14:02,216.216] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: 'tuple' object has no attribute 'metadata'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 86, in search_in_datasets
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 86, in <genexpr>
    unique_dataset_ids = list(set(str(lc_document.metadata["dataset_id"]) for lc_document in lc_documents))
AttributeError: 'tuple' object has no attribute 'metadata'
[2025-07-17 23:14:02,221.221] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:14:02,230.230] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:14:02] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:16:05,982.982] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:16:06,357.357] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:16:09,255.255] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:16:09,272.272] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:16:12,000.000] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:16:12,000.000] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:16:12,001.001] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:16:12,001.001] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:16:12,002.002] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:16:12,002.002] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:16:12,003.003] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:12,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:16:12,005.005] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:12,009.009] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:16:12,009.009] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:12,268.268] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:16:12,269.269] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '接口文档', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:16:12,324.324] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:16:12,327.327] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:12,330.330] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:16:12,330.330] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'hit_count_1': 1, 'id_1_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8'), 'id_1_2': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099'), 'id_1_3': UUID('00bbd644-a575-4c8a-b531-464fa2608a96'), 'id_1_4': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4'), 'id_1_5': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5'), 'id_1_6': UUID('9eb90b96-6ab5-4eeb-a316-414be7c2ee3a')}
[2025-07-17 23:16:12,338.338] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:16:12,339.339] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:12,342.342] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:16:12,342.342] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'id_1_1': '3427230b-8b0e-4b94-bbcb-e658ce57c0c8', 'id_1_2': 'c49d7eeb-c574-45f4-ae3f-6846053de099', 'id_1_3': '00bbd644-a575-4c8a-b531-464fa2608a96', 'id_1_4': 'e0f8d56e-d3d5-45c5-8488-2accf171daf4', 'id_1_5': 'd5fed778-2d8f-4f31-bf63-a7a56cf6fee5', 'id_1_6': '9eb90b96-6ab5-4eeb-a316-414be7c2ee3a'}
[2025-07-17 23:16:12,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:16:12,351.351] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-17 23:16:12,355.355] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,355.355] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004447s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,360.360] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,360.360] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005641s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,362.362] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,362.362] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007514s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,364.364] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008751s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,364.364] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:16:12,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0138s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:16:12,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:12,366.366] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01082s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:12,369.369] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:16:12,370.370] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:16:12] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:16:37,500.500] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:37,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:16:37,501.501] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.5s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:37,505.505] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:16:37,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.5s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:37,709.709] base.py -> similarity_search_with_relevance_scores line:576 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.8
[2025-07-17 23:16:37,711.711] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:16:37,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.38s ago] {'hit_count_1': 1}
[2025-07-17 23:16:37,724.724] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:16:37,726.726] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:37,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:16:37,726.726] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.38s ago] {}
[2025-07-17 23:16:37,728.728] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:16:37,728.728] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:16:37] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:16:47,199.199] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:47,200.200] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:16:47,200.200] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.19s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:47,202.202] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:16:47,202.202] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.19s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:16:47,400.400] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:16:47,401.401] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.13s ago] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '接口文档', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:16:47,406.406] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:16:47,418.418] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:47,421.421] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:16:47,421.421] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.09s ago] {'hit_count_1': 1, 'id_1_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8'), 'id_1_2': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099'), 'id_1_3': UUID('00bbd644-a575-4c8a-b531-464fa2608a96'), 'id_1_4': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4'), 'id_1_5': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5'), 'id_1_6': UUID('9eb90b96-6ab5-4eeb-a316-414be7c2ee3a')}
[2025-07-17 23:16:47,423.423] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:16:47,424.424] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:16:47,424.424] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:16:47,424.424] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'id_1_1': '3427230b-8b0e-4b94-bbcb-e658ce57c0c8', 'id_1_2': 'c49d7eeb-c574-45f4-ae3f-6846053de099', 'id_1_3': '00bbd644-a575-4c8a-b531-464fa2608a96', 'id_1_4': 'e0f8d56e-d3d5-45c5-8488-2accf171daf4', 'id_1_5': 'd5fed778-2d8f-4f31-bf63-a7a56cf6fee5', 'id_1_6': '9eb90b96-6ab5-4eeb-a316-414be7c2ee3a'}
[2025-07-17 23:16:47,430.430] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:16:47,430.430] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-17 23:16:47,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,432.432] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,439.439] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,439.439] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.08s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,440.440] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,440.440] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.09s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:16:47,441.441] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.09s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:16:47,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:16:47,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.09s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:16:47,444.444] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:16:47,445.445] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:16:47] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:18:12,449.449] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:18:12,860.860] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:18:15,861.861] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:18:15,876.876] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:18:27,460.460] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:18:27,461.461] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:18:27,462.462] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:18:27,462.462] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:18:27,462.462] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:18:27,463.463] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:18:27,463.463] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:18:27,465.465] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:18:27,465.465] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:18:27,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:18:27,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:18:27,716.716] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:18:27,716.716] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '接口文档', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:18:27,721.721] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:18:27,723.723] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:18:27,725.725] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:18:27,725.725] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'hit_count_1': 1, 'id_1_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8'), 'id_1_2': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099'), 'id_1_3': UUID('00bbd644-a575-4c8a-b531-464fa2608a96'), 'id_1_4': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4'), 'id_1_5': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5'), 'id_1_6': UUID('9eb90b96-6ab5-4eeb-a316-414be7c2ee3a')}
[2025-07-17 23:18:27,728.728] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:18:27,729.729] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:18:27,731.731] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:18:27,731.731] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'id_1_1': '3427230b-8b0e-4b94-bbcb-e658ce57c0c8', 'id_1_2': 'c49d7eeb-c574-45f4-ae3f-6846053de099', 'id_1_3': '00bbd644-a575-4c8a-b531-464fa2608a96', 'id_1_4': 'e0f8d56e-d3d5-45c5-8488-2accf171daf4', 'id_1_5': 'd5fed778-2d8f-4f31-bf63-a7a56cf6fee5', 'id_1_6': '9eb90b96-6ab5-4eeb-a316-414be7c2ee3a'}
[2025-07-17 23:18:27,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:18:27,735.735] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-17 23:18:27,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,738.738] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,740.740] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.001948s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002611s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003158s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,742.742] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003894s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:18:27,743.743] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008551s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:18:27,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:18:27,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00595s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:18:27,746.746] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:18:27,746.746] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:18:27] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:19:55,452.452] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py', reloading
[2025-07-17 23:19:55,847.847] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:19:58,723.723] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:19:58,737.737] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:20:03,995.995] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:20:04,335.335] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:20:07,057.057] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:20:07,073.073] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:20:07,245.245] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:20:07,246.246] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:20:07,247.247] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:20:07,247.247] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:20:07,248.248] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:20:07,248.248] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:20:07,249.249] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:20:07,253.253] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:20:07,254.254] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:20:07,262.262] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:20:07,262.262] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:20:07,363.363] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: langchain_core.vectorstores.base.VectorStore.similarity_search_with_relevance_scores() got multiple values for keyword argument 'k'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 77, in search_in_datasets
    lc_documents = semantic_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 30, in _get_relevant_documents
    search_result = self.vector_store.similarity_search_with_relevance_scores(
TypeError: langchain_core.vectorstores.base.VectorStore.similarity_search_with_relevance_scores() got multiple values for keyword argument 'k'
[2025-07-17 23:20:07,366.366] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:20:07,372.372] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:20:07] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:21:34,824.824] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:21:35,249.249] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:21:38,105.105] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:21:38,119.119] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:22:08,403.403] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:22:08,807.807] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:22:11,629.629] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:22:11,644.644] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:22:28,471.471] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:22:28,807.807] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:22:31,664.664] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:22:31,680.680] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:22:32,799.799] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:22:33,122.122] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:22:35,524.524] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:22:35,539.539] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:22:43,120.120] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:22:43,120.120] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:22:43,121.121] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:22:43,121.121] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:22:43,122.122] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:22:43,122.122] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:22:43,122.122] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:22:43,124.124] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:22:43,124.124] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:22:43,129.129] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:22:43,129.129] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:22:43,233.233] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: not enough values to unpack (expected 2, got 1)
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 77, in search_in_datasets
    lc_documents = semantic_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 39, in _get_relevant_documents
    **{k: v for k, v in self.search_kwargs if k != 'k'},
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 39, in <dictcomp>
    **{k: v for k, v in self.search_kwargs if k != 'k'},
ValueError: not enough values to unpack (expected 2, got 1)
[2025-07-17 23:22:43,236.236] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:22:43,243.243] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:22:43] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:23:05,014.014] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:23:05,408.408] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:23:08,323.323] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:23:08,341.341] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:23:09,709.709] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:23:09,709.709] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:09,710.710] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:23:09,710.710] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:09,711.711] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:23:09,711.711] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:09,712.712] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:23:09,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:23:09,713.713] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:23:09,717.717] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:23:09,718.718] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:23:09,783.783] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: not enough values to unpack (expected 2, got 1)
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 77, in search_in_datasets
    lc_documents = semantic_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 28, in _get_relevant_documents
    print({k: v for k, v in self.search_kwargs if k != 'k'}, '----')
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py", line 28, in <dictcomp>
    print({k: v for k, v in self.search_kwargs if k != 'k'}, '----')
ValueError: not enough values to unpack (expected 2, got 1)
[2025-07-17 23:23:09,785.785] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:23:09,792.792] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:23:09] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:23:38,119.119] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:23:38,451.451] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:23:41,246.246] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:23:41,259.259] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:23:43,444.444] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:23:43,773.773] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:23:46,334.334] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:23:46,351.351] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:23:46,636.636] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:23:46,636.636] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:46,638.638] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:23:46,638.638] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:46,639.639] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:23:46,639.639] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:23:46,640.640] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:23:46,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:23:46,642.642] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:23:46,646.646] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:23:46,646.646] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:23:46,877.877] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:23:46,877.877] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '接口文档', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:23:46,885.885] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:23:46,888.888] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:23:46,889.889] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:23:46,889.889] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'hit_count_1': 1, 'id_1_1': UUID('3427230b-8b0e-4b94-bbcb-e658ce57c0c8'), 'id_1_2': UUID('c49d7eeb-c574-45f4-ae3f-6846053de099'), 'id_1_3': UUID('00bbd644-a575-4c8a-b531-464fa2608a96'), 'id_1_4': UUID('e0f8d56e-d3d5-45c5-8488-2accf171daf4'), 'id_1_5': UUID('d5fed778-2d8f-4f31-bf63-a7a56cf6fee5'), 'id_1_6': UUID('9eb90b96-6ab5-4eeb-a316-414be7c2ee3a')}
[2025-07-17 23:23:46,897.897] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:23:46,899.899] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:23:46,900.900] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:23:46,901.901] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'id_1_1': '3427230b-8b0e-4b94-bbcb-e658ce57c0c8', 'id_1_2': 'c49d7eeb-c574-45f4-ae3f-6846053de099', 'id_1_3': '00bbd644-a575-4c8a-b531-464fa2608a96', 'id_1_4': 'e0f8d56e-d3d5-45c5-8488-2accf171daf4', 'id_1_5': 'd5fed778-2d8f-4f31-bf63-a7a56cf6fee5', 'id_1_6': '9eb90b96-6ab5-4eeb-a316-414be7c2ee3a'}
[2025-07-17 23:23:46,907.907] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:23:46,907.907] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-17 23:23:46,910.910] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,910.910] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,915.915] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,915.915] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004749s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,916.916] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,916.916] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005578s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,916.916] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,916.916] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006185s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,917.917] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,917.917] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006824s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,917.917] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:23:46,917.917] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01092s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:23:46,918.918] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:23:46,918.918] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008282s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:23:46,921.921] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:23:46,921.921] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:23:46] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:24:06,366.366] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/semantic_retriever.py', reloading
[2025-07-17 23:24:06,693.693] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:24:09,396.396] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:24:09,409.409] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:24:10,737.737] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:24:10,737.737] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:24:10,738.738] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:24:10,738.738] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:24:10,739.739] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:24:10,739.739] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:24:10,739.739] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:24:10,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:24:10,741.741] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:24:10,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:24:10,745.745] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:24:10,810.810] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:24:11,338.338] __init__.py -> initialize line:146 [DEBUG]: Dumping model to file cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:24:11,379.379] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.569 seconds.
[2025-07-17 23:24:11,379.379] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:24:11,381.381] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:24:11,381.381] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:24:11,391.391] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: items
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 199, in _key_not_found
    self._key_fallback(key, None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 138, in _key_fallback
    raise KeyError(key) from err
KeyError: 'items'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 79, in search_in_datasets
    lc_documents = full_text_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py", line 46, in _get_relevant_documents
    for keyword, segment_ids in keyword_table.items():
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 66, in sqlalchemy.cyextension.resultproxy.BaseRow.__getattr__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 63, in sqlalchemy.cyextension.resultproxy.BaseRow._get_by_key_impl
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 201, in _key_not_found
    raise AttributeError(ke.args[0]) from ke
AttributeError: items
[2025-07-17 23:24:11,393.393] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:24:11,402.402] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:24:11] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:32:26,393.393] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:32:26,849.849] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:32:29,785.785] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:32:29,799.799] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:32:42,409.409] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:32:42,410.410] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:32:42,411.411] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:32:42,411.411] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:32:42,411.411] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:32:42,411.411] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:32:42,412.412] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:32:42,414.414] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:32:42,414.414] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:32:42,418.418] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:32:42,418.418] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:32:42,517.517] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:32:42,517.517] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:32:42,957.957] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.439 seconds.
[2025-07-17 23:32:42,957.957] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:32:42,959.959] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:32:42,959.959] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:32:42,966.966] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: items
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 199, in _key_not_found
    self._key_fallback(key, None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 138, in _key_fallback
    raise KeyError(key) from err
KeyError: 'items'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 79, in search_in_datasets
    lc_documents = full_text_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py", line 46, in _get_relevant_documents
    print(keyword_table.items(), '------')
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 66, in sqlalchemy.cyextension.resultproxy.BaseRow.__getattr__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 63, in sqlalchemy.cyextension.resultproxy.BaseRow._get_by_key_impl
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 201, in _key_not_found
    raise AttributeError(ke.args[0]) from ke
AttributeError: items
[2025-07-17 23:32:42,971.971] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:32:42,985.985] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:32:42] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:32:58,801.801] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:32:59,147.147] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:33:02,026.026] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:33:02,038.038] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:33:03,152.152] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:33:03,477.477] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:33:05,913.913] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:33:05,927.927] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:33:08,937.937] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:33:08,937.937] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:33:08,938.938] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:33:08,938.938] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:33:08,938.938] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:33:08,939.939] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:33:08,939.939] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:33:08,942.942] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:33:08,942.942] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:08,945.945] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:33:08,945.945] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:09,019.019] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:33:09,019.019] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:33:09,459.459] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.440 seconds.
[2025-07-17 23:33:09,460.460] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:33:09,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:33:09,462.462] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:09,468.468] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: items
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 199, in _key_not_found
    self._key_fallback(key, None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 138, in _key_fallback
    raise KeyError(key) from err
KeyError: 'items'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 79, in search_in_datasets
    lc_documents = full_text_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py", line 47, in _get_relevant_documents
    print(keyword_table.items(), '------')
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 66, in sqlalchemy.cyextension.resultproxy.BaseRow.__getattr__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 63, in sqlalchemy.cyextension.resultproxy.BaseRow._get_by_key_impl
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 201, in _key_not_found
    raise AttributeError(ke.args[0]) from ke
AttributeError: items
[2025-07-17 23:33:09,471.471] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:33:09,483.483] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:33:09] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:33:57,603.603] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:33:57,603.603] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:33:57,603.603] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.66s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:57,604.604] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:33:57,605.605] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.66s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:57,606.606] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:33:57,606.606] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.14s ago] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:33:57,608.608] http.py -> _register_error_handler line:70 [ERROR]: An error occurred: items
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 199, in _key_not_found
    self._key_fallback(key, None)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 138, in _key_fallback
    raise KeyError(key) from err
KeyError: 'items'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/dataset_handler.py", line 90, in hit
    hit_result = self.dataset_service.hit(dataset_id, req)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/dataset_service.py", line 151, in hit
    lc_documents = self.retrieval_service.search_in_datasets(dataset_ids=[dataset_id], **req.data)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/service/retrieval_service.py", line 79, in search_in_datasets
    lc_documents = full_text_retriever.invoke(query)[:k]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/langchain_core/retrievers.py", line 259, in invoke
    result = self._get_relevant_documents(
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py", line 47, in _get_relevant_documents
    print(keyword_table.items(), '------')
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 66, in sqlalchemy.cyextension.resultproxy.BaseRow.__getattr__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 63, in sqlalchemy.cyextension.resultproxy.BaseRow._get_by_key_impl
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/sqlalchemy/engine/result.py", line 201, in _key_not_found
    raise AttributeError(ke.args[0]) from ke
AttributeError: items
[2025-07-17 23:33:57,609.609] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:33:57,617.617] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:33:57] "[35m[1mPOST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1[0m" 500 -
[2025-07-17 23:33:57,896.896] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:33:58,228.228] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:34:01,203.203] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:34:01,216.216] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:35:36,385.385] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:35:36,737.737] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:35:39,600.600] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:35:39,615.615] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:35:39,785.785] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:35:39,785.785] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:35:39,788.788] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:35:39,788.788] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:35:39,789.789] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:35:39,790.790] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:35:39,790.790] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:35:39,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:35:39,796.796] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00230s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:35:39,805.805] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:35:39,805.805] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:35:39,944.944] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:35:39,944.944] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:35:40,379.379] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.436 seconds.
[2025-07-17 23:35:40,380.380] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:35:40,382.382] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:35:40,382.382] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:35:40,385.385] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:35:40,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003542s ago] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:35:40,388.388] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:35:40,388.388] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {}
[2025-07-17 23:35:40,391.391] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:35:40,391.391] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'hit_count_1': 1}
[2025-07-17 23:35:40,392.392] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:35:40,393.393] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:35:40,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:35:40,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004741s ago] {}
[2025-07-17 23:35:40,394.394] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:35:40,395.395] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:35:40] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:36:07,050.050] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:36:07,398.398] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:36:10,048.048] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:36:10,093.093] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:36:10,211.211] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:36:10,211.211] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:36:10,213.213] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:36:10,213.213] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:36:10,217.217] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:36:10,217.217] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:36:10,218.218] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:36:10,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:36:10,222.222] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:36:10,227.227] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:36:10,227.227] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:36:10,328.328] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:36:10,329.329] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:36:10,762.762] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.433 seconds.
[2025-07-17 23:36:10,762.762] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:36:10,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:36:10,765.765] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:36:10,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:36:10,770.770] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {}
[2025-07-17 23:36:10,774.774] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:36:10,774.774] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'hit_count_1': 1}
[2025-07-17 23:36:10,775.775] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:36:10,775.775] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:36:10,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:36:10,775.775] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005521s ago] {}
[2025-07-17 23:36:10,777.777] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:36:10,777.777] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:36:10] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:36:36,523.523] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:36:36,846.846] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:36:39,581.581] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:36:39,627.627] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:46:45,014.014] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:46:45,456.456] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:46:48,382.382] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:46:48,398.398] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:46:48,553.553] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:46:48,553.553] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:46:48,555.555] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:46:48,555.555] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:46:48,556.556] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:46:48,556.556] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:46:48,557.557] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:46:48,562.562] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:46:48,562.562] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:46:48,567.567] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:46:48,568.568] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:46:48,712.712] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:46:48,713.713] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:46:49,153.153] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.440 seconds.
[2025-07-17 23:46:49,153.153] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:46:49,155.155] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:46:49,155.155] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:46:49,158.158] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:46:49,158.158] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {}
[2025-07-17 23:46:49,162.162] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:46:49,162.162] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'hit_count_1': 1}
[2025-07-17 23:46:49,163.163] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:46:49,163.163] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:46:49,163.163] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:46:49,163.163] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005188s ago] {}
[2025-07-17 23:46:49,165.165] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:46:49,165.165] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:46:49] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:47:08,531.531] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:47:08,892.892] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:47:11,491.491] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:47:11,506.506] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:47:45,703.703] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:47:45,703.703] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:47:45,704.704] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:47:45,704.704] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:47:45,705.705] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:47:45,705.705] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:47:45,705.705] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:47:45,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:47:45,707.707] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:45,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:47:45,712.712] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:45,843.843] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:47:45,844.844] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:47:46,288.288] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.444 seconds.
[2025-07-17 23:47:46,288.288] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:47:46,290.290] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:47:46,290.290] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:46,296.296] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:46,296.296] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {}
[2025-07-17 23:47:46,299.299] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:46,299.299] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00014s] {'hit_count_1': 1}
[2025-07-17 23:47:46,299.299] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:47:46,300.300] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:47:46,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:46,300.300] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003917s ago] {}
[2025-07-17 23:47:46,301.301] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:47:46,301.301] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:47:46] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:47:55,068.068] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:47:55,069.069] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:47:55,069.069] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.362s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:55,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:47:55,072.072] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.36s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:55,075.075] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:47:55,075.075] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.785s ago] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:47:55,079.079] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:55,079.079] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.783s ago] {}
[2025-07-17 23:47:55,082.082] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:55,082.082] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.784s ago] {'hit_count_1': 1}
[2025-07-17 23:47:55,083.083] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:47:55,084.084] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:47:55,084.084] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:47:55,084.084] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.789s ago] {}
[2025-07-17 23:47:55,086.086] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:47:55,087.087] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:47:55] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:48:14,898.898] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:48:15,243.243] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:48:18,101.101] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:48:18,116.116] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:48:18,279.279] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:48:18,280.280] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:18,281.281] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:48:18,282.282] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:18,282.282] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:48:18,282.282] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:18,283.283] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:18,288.288] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:48:18,288.288] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:18,292.292] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:48:18,292.292] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00015s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:18,391.391] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:48:18,391.391] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:48:18,832.832] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.440 seconds.
[2025-07-17 23:48:18,832.832] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:48:18,834.834] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:48:18,834.834] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:18,840.840] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:48:18,840.840] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {}
[2025-07-17 23:48:18,843.843] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:48:18,843.843] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'hit_count_1': 1}
[2025-07-17 23:48:18,844.844] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:48:18,846.846] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:18,846.846] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-07-17 23:48:18,846.846] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006085s ago] {}
[2025-07-17 23:48:18,847.847] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:48:18,847.847] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:48:18] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:48:37,999.999] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:37,999.999] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:48:37,999.999] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.71s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:38,001.001] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:48:38,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.71s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:38,002.002] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:48:38,002.002] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:38,003.003] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:38,004.004] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.16s ago] {'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': '8a769d44-d5b6-41d2-a938-5c97ad94b731', 'id_1_3': '3f45066e-ae55-4ea6-ae9f-d5ef456b8362', 'id_1_4': '6a61e136-7a70-45a2-a0fa-26691d2e63ad', 'id_1_5': '55a40d33-7a0c-4601-9998-2f5cf1958931', 'id_1_6': 'bfee1970-9b9f-470c-b254-25b2d018beee'}
[2025-07-17 23:48:38,007.007] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:48:38,007.007] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '诉讼请求', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:48:38,015.015] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:48:38,017.017] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:38,017.017] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:38,017.017] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'hit_count_1': 1, 'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': '8a769d44-d5b6-41d2-a938-5c97ad94b731', 'id_1_3': '3f45066e-ae55-4ea6-ae9f-d5ef456b8362', 'id_1_4': '6a61e136-7a70-45a2-a0fa-26691d2e63ad', 'id_1_5': '55a40d33-7a0c-4601-9998-2f5cf1958931', 'id_1_6': 'bfee1970-9b9f-470c-b254-25b2d018beee'}
[2025-07-17 23:48:38,018.018] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:48:38,019.019] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:38,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:38,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': '8a769d44-d5b6-41d2-a938-5c97ad94b731', 'id_1_3': '3f45066e-ae55-4ea6-ae9f-d5ef456b8362', 'id_1_4': '6a61e136-7a70-45a2-a0fa-26691d2e63ad', 'id_1_5': '55a40d33-7a0c-4601-9998-2f5cf1958931', 'id_1_6': 'bfee1970-9b9f-470c-b254-25b2d018beee'}
[2025-07-17 23:48:38,023.023] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,023.023] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'pk_1': UUID('61b9ae1d-54c0-4de2-8e6a-9abb80e8e8cd')}
[2025-07-17 23:48:38,025.025] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,025.025] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00016s] {'id_1': UUID('252b8261-f973-4ec7-9349-aaa716646deb')}
[2025-07-17 23:48:38,027.027] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,027.027] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004581s ago] {'pk_1': UUID('9ab6dafa-f9de-4778-8a47-ff842df9f662')}
[2025-07-17 23:48:38,028.028] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00299s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:38,029.029] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,029.029] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006459s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:48:38,030.030] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,030.030] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004632s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:38,031.031] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,031.031] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008018s ago] {'pk_1': UUID('c341230b-7beb-4d78-8d04-d66b6223fba5')}
[2025-07-17 23:48:38,031.031] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,032.032] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006251s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:38,052.052] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,052.052] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02917s ago] {'pk_1': UUID('92c0d352-692e-48a2-bd07-74a5634a7fd2')}
[2025-07-17 23:48:38,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0276s ago] {'id_1': UUID('252b8261-f973-4ec7-9349-aaa716646deb')}
[2025-07-17 23:48:38,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:38,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03108s ago] {'pk_1': UUID('89e077db-e708-4084-83ef-57e502d51987')}
[2025-07-17 23:48:38,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:38,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02916s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:38,056.056] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:48:38,056.056] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:48:38] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
[2025-07-17 23:48:49,839.839] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/core/retrievers/full_text_retrievers.py', reloading
[2025-07-17 23:48:50,191.191] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-07-17 23:48:53,188.188] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-07-17 23:48:53,202.202] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 133-334-152
[2025-07-17 23:48:58,082.082] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-07-17 23:48:58,082.082] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:58,083.083] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-07-17 23:48:58,083.083] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:58,084.084] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-07-17 23:48:58,084.084] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-07-17 23:48:58,084.084] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:58,087.087] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-07-17 23:48:58,087.087] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:58,091.091] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-07-17 23:48:58,091.091] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00018s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:58,186.186] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-07-17 23:48:58,186.186] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache /var/folders/8n/sf82vkjs4fj6k504_cf8pw000000gp/T/jieba.cache
[2025-07-17 23:48:58,618.618] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.432 seconds.
[2025-07-17 23:48:58,618.618] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-07-17 23:48:58,620.620] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-07-17 23:48:58,620.620] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'dataset_id_1_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-07-17 23:48:58,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:58,625.625] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': '8a769d44-d5b6-41d2-a938-5c97ad94b731', 'id_1_3': '3f45066e-ae55-4ea6-ae9f-d5ef456b8362', 'id_1_4': '6a61e136-7a70-45a2-a0fa-26691d2e63ad', 'id_1_5': '55a40d33-7a0c-4601-9998-2f5cf1958931', 'id_1_6': 'bfee1970-9b9f-470c-b254-25b2d018beee'}
[2025-07-17 23:48:58,802.802] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-07-17 23:48:58,803.803] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'dataset_id': '6c5e3fd6-6307-4eb5-b017-895b25ce4a1c', 'query': '诉讼请求', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-07-17 23:48:58,807.807] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:48:58,809.809] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:58,810.810] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:58,810.810] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'hit_count_1': 1, 'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': UUID('9eb90b96-6ab5-4eeb-a316-414be7c2ee3a'), 'id_1_3': UUID('46ea57e2-d0b9-4d8a-be77-6985c34b54f6'), 'id_1_4': UUID('3a2de3ff-0353-462a-8411-bc1da048d8ec'), 'id_1_5': UUID('e8a635fc-e579-4be8-83fa-c8f513964668'), 'id_1_6': UUID('2279e9c7-7768-43a2-a5e7-99ca02c9154f')}
[2025-07-17 23:48:58,813.813] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-07-17 23:48:58,814.814] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-07-17 23:48:58,815.815] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID)
[2025-07-17 23:48:58,815.815] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1903s ago] {'id_1_1': 'e30bf24b-7ac5-4167-a5f4-7951c07b90dc', 'id_1_2': '9eb90b96-6ab5-4eeb-a316-414be7c2ee3a', 'id_1_3': '46ea57e2-d0b9-4d8a-be77-6985c34b54f6', 'id_1_4': '3a2de3ff-0353-462a-8411-bc1da048d8ec', 'id_1_5': 'e8a635fc-e579-4be8-83fa-c8f513964668', 'id_1_6': '2279e9c7-7768-43a2-a5e7-99ca02c9154f'}
[2025-07-17 23:48:58,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:58,819.819] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00017s] {'pk_1': UUID('61b9ae1d-54c0-4de2-8e6a-9abb80e8e8cd')}
[2025-07-17 23:48:58,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,826.826] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'id_1': UUID('252b8261-f973-4ec7-9349-aaa716646deb')}
[2025-07-17 23:48:58,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-07-17 23:48:58,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009091s ago] {'pk_1': UUID('53668bbf-c0f8-4ed5-8bd4-ea730301d0f1')}
[2025-07-17 23:48:58,829.829] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004229s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:58,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005164s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:58,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006198s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:58,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007019s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:58,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-07-17 23:48:58,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008082s ago] {'id_1': UUID('a11040c0-0de1-45c8-8803-d0ed52c24979')}
[2025-07-17 23:48:58,836.836] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-07-17 23:48:58,836.836] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/Jul/2025 23:48:58] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/hit HTTP/1.1" 200 -
