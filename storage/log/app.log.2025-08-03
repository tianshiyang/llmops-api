[2025-08-03 00:38:58,400.400] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-08-03 00:38:58,401.401] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-08-03 00:38:58,402.402] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-03 00:38:59,850.850] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-03 00:38:59,861.861] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 682-461-187
[2025-08-03 00:41:14,781.781] http.py -> _register_error_handler line:71 [ERROR]: An error occurred: BaseAgent.__init__() missing 1 required positional argument: 'agent_queue_manager'
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/app_handler.py", line 135, in ping
    agent = FunctionCallAgent(AgentConfig(
TypeError: BaseAgent.__init__() missing 1 required positional argument: 'agent_queue_manager'
[2025-08-03 00:41:14,785.785] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 00:41:14] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-08-03 00:41:31,191.191] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 00:41:31] "POST /apps/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/debug HTTP/1.1" 200 -
[2025-08-03 00:45:41,785.785] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 00:45:41] "POST /app/completion HTTP/1.1" 200 -
[2025-08-03 00:46:25,018.018] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 00:46:25] "POST /app/completion HTTP/1.1" 200 -
[2025-08-03 01:57:36,925.925] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-03 01:57:36,935.935] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 682-461-187
[2025-08-03 01:59:02,623.623] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-08-03 01:59:02,623.623] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-08-03 01:59:02,624.624] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-03 01:59:04,108.108] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-03 01:59:04,119.119] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 682-461-187
[2025-08-03 01:59:26,464.464] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:26] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:26,465.465] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:26] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:26,498.498] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-08-03 01:59:26,498.498] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 01:59:26,498.498] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-08-03 01:59:26,498.498] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 01:59:26,499.499] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-08-03 01:59:26,499.499] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 01:59:26,499.499] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:26,499.499] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:26,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:26,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:26,501.501] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,501.501] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0003122s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,504.504] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:26,504.504] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,506.506] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 01:59:26,506.506] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:26,506.506] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00080s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 01:59:26,506.506] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,508.508] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:26,509.509] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 01:59:26,509.509] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00120s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,509.509] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 01:59:26,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,510.510] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00007s] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 01:59:26,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:26,511.511] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00009s] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:26,511.511] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,511.511] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:26,512.512] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.001584s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 01:59:26,512.512] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:26] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:26,512.512] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,512.512] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002235s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 01:59:26,513.513] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,513.513] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002897s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 01:59:26,513.513] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,513.513] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003263s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003602s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003915s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004465s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 01:59:26,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,515.515] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004852s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 01:59:26,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,515.515] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005208s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 01:59:26,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,516.516] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005554s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 01:59:26,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,516.516] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00598s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 01:59:26,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,516.516] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006424s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 01:59:26,517.517] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,517.517] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007061s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 01:59:26,517.517] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,517.517] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007481s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 01:59:26,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,518.518] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007853s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 01:59:26,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,518.518] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008207s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 01:59:26,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,519.519] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008547s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 01:59:26,519.519] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,519.519] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008884s ago] {'coalesce_2': 0, 'document_id_1': UUID('979c0745-5cbc-43d3-ab03-4eb2dccf2acf')}
[2025-08-03 01:59:26,519.519] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:26,519.519] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009268s ago] {'coalesce_2': 0, 'document_id_1': UUID('0ac2bae1-e440-4632-b46a-e6c9b9e410c1')}
[2025-08-03 01:59:26,521.521] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:26,521.521] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:26] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:33,026.026] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:33,030.030] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-08-03 01:59:33,030.030] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'name': 'ã€aiäº§å“ç»ç†_åŒ—äº¬ 15-30Kã€‘æ®µåšæ¶µ 8å¹´.pdf', 'key': '2025/08/03/b59d0e34-a961-4d44-9c6a-1ff7af7b804d.pdf', 'size': 2898649, 'extension': 'pdf', 'mime_type': 'application/pdf', 'hash': 'fbebff9880c9c8d2be7fe675f5f568e9273c3c6d9dff5008bc341c4115722e04'}
[2025-08-03 01:59:33,036.036] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 01:59:33,038.038] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:33,040.040] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-08-03 01:59:33,040.040] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('6b7753a0-bff6-4392-8631-cba5744e2d51')}
[2025-08-03 01:59:33,044.044] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:33,045.045] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:33] "POST /upload-files/file HTTP/1.1" 200 -
[2025-08-03 01:59:44,619.619] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:44] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents HTTP/1.1" 200 -
[2025-08-03 01:59:44,631.631] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:44,631.631] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:44,632.632] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.13s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:44,634.634] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-08-03 01:59:44,635.635] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': '6b7753a0-bff6-4392-8631-cba5744e2d51'}
[2025-08-03 01:59:44,638.638] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-08-03 01:59:44,638.638] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'mode': 'automatic', 'rule': '{"pre_process_rules": {"id": "remove_extra_space", "enabled": true}}'}
[2025-08-03 01:59:44,641.641] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 01:59:44,648.648] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:44,653.653] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-08-03 01:59:44,653.653] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'param_1': 1}
[2025-08-03 01:59:44,654.654] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-08-03 01:59:44,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.62s ago] {'pk_1': UUID('6b7753a0-bff6-4392-8631-cba5744e2d51')}
[2025-08-03 01:59:44,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-08-03 01:59:44,657.657] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'pk_1': UUID('965ab072-7193-49bc-becf-99f8d22e3e41')}
[2025-08-03 01:59:44,659.659] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-08-03 01:59:44,659.659] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'upload_file_id': UUID('6b7753a0-bff6-4392-8631-cba5744e2d51'), 'process_rule_id': UUID('965ab072-7193-49bc-becf-99f8d22e3e41'), 'batch': '20250803015944311892', 'name': 'ã€aiäº§å“ç»ç†_åŒ—äº¬ 15-30Kã€‘æ®µåšæ¶µ 8å¹´.pdf', 'position': 157, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-08-03 01:59:44,661.661] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 01:59:44,666.666] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:44,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-08-03 01:59:44,666.666] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00009s] {'pk_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 01:59:44,707.707] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:44,707.707] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:44] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents HTTP/1.1" 200 -
[2025-08-03 01:59:44,710.710] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:44] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/batch/20250803015944311892 HTTP/1.1" 200 -
[2025-08-03 01:59:44,711.711] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:44,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:44,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.21s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:44,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s
[2025-08-03 01:59:44,713.713] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00011s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'batch_1': '20250803015944311892'}
[2025-08-03 01:59:44,715.715] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:44,715.715] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00007s] {'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 01:59:44,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-08-03 01:59:44,716.716] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00008s] {'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-08-03 01:59:44,717.717] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-08-03 01:59:44,717.717] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'id_1': UUID('6b7753a0-bff6-4392-8631-cba5744e2d51')}
[2025-08-03 01:59:44,718.718] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:44,718.718] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:44] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/batch/20250803015944311892 HTTP/1.1" 200 -
[2025-08-03 01:59:45,669.669] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:45] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:45,670.670] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:45] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:45,671.671] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:45,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:45,672.672] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,673.673] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:45,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:45,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:45,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,677.677] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:45,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 01:59:45,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 01:59:45,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:45,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 01:59:45,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 01:59:45,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:45,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:45,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 01:59:45,683.683] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:45,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 01:59:45,684.684] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:45] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:45,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.17s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 01:59:45,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 01:59:45,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 01:59:45,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 01:59:45,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 01:59:45,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 01:59:45,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 01:59:45,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 01:59:45,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 01:59:45,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,690.690] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 01:59:45,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,690.690] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 01:59:45,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 01:59:45,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,692.692] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 01:59:45,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 01:59:45,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 01:59:45,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 01:59:45,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.18s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 01:59:45,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:45,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.19s ago] {'coalesce_2': 0, 'document_id_1': UUID('979c0745-5cbc-43d3-ab03-4eb2dccf2acf')}
[2025-08-03 01:59:45,697.697] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:45,698.698] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:45] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:49,756.756] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:49,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:49,757.757] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,757.757] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:49,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:49,757.757] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,758.758] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:49,759.759] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 01:59:49,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 01:59:49,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:49,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 01:59:49,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 01:59:49,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:49,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,761.761] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,761.761] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 01:59:49,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:49,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:49,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 01:59:49,763.763] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:49,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,764.764] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:49] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:49,764.764] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 01:59:49,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,764.764] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.25s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 01:59:49,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 01:59:49,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 01:59:49,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 01:59:49,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:49,770.770] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.26s ago] {'coalesce_2': 0, 'document_id_1': UUID('979c0745-5cbc-43d3-ab03-4eb2dccf2acf')}
[2025-08-03 01:59:49,773.773] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:49,773.773] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:49] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:57,914.914] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:57] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:57,916.916] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:57] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 01:59:57,918.918] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:57,919.919] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:57,919.919] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,921.921] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 01:59:57,921.921] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 01:59:57,921.921] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,923.923] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:57,923.923] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,924.924] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 01:59:57,925.925] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:57,925.925] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 01:59:57,925.925] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 01:59:57,928.928] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 01:59:57,928.928] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:57,929.929] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,929.929] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 01:59:57,930.930] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,930.930] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 01:59:57,931.931] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 01:59:57,932.932] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:57,933.933] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,933.933] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 01:59:57,933.933] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:57] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 01:59:57,934.934] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,934.934] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.42s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 01:59:57,934.934] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,934.934] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.43s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 01:59:57,935.935] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,935.935] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.43s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 01:59:57,935.935] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,935.935] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.43s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 01:59:57,936.936] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,936.936] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.43s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 01:59:57,939.939] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,939.939] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.43s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 01:59:57,945.945] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,945.945] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 01:59:57,945.945] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,945.945] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 01:59:57,946.946] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 01:59:57,946.946] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 01:59:57,947.947] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,947.947] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 01:59:57,948.948] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,948.948] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 01:59:57,949.949] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,949.949] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 01:59:57,949.949] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,949.949] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 01:59:57,949.949] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 01:59:57,951.951] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,951.951] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 01:59:57,952.952] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 01:59:57,952.952] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 01:59:57,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.44s ago] {'coalesce_2': 0, 'document_id_1': UUID('979c0745-5cbc-43d3-ab03-4eb2dccf2acf')}
[2025-08-03 01:59:57,954.954] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 01:59:57,954.954] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 01:59:57] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:00:58,363.363] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:00:58,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:00:58,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:00:58,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:00:58,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:00:58,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:00:58,373.373] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:00:58,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,376.376] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:00:58,378.378] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,378.378] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:00:58,379.379] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,379.379] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:00:58,381.381] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,381.381] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:00:58,382.382] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,382.382] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:00:58,383.383] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,383.383] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.87s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:00:58,384.384] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,384.384] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:00:58,385.385] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:00:58,386.386] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,386.386] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:00:58,387.387] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,387.387] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:00:58,388.388] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,388.388] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:00:58,389.389] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:00:58,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:00:58,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:00:58,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:00:58,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.88s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:00:58,394.394] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,394.394] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.89s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:00:58,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.89s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:00:58,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.89s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:00:58,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:00:58,397.397] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.89s ago] {'coalesce_2': 0, 'document_id_1': UUID('979c0745-5cbc-43d3-ab03-4eb2dccf2acf')}
[2025-08-03 02:00:58,399.399] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:00:58,399.399] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:00:58] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:09,999.999] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:10,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:10,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.5s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:10,003.003] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-08-03 02:01:10,003.003] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.37s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': '60a2f589-dc7a-495b-939d-3b187b8d8468'}
[2025-08-03 02:01:10,005.005] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-08-03 02:01:10,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.37s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": false}], "segment": {"separators": ["\\n"], "chunk_size": 500, "chunk_overlap": 50}}'}
[2025-08-03 02:01:10,007.007] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 02:01:10,009.009] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:10,010.010] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-08-03 02:01:10,010.010] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.36s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'param_1': 1}
[2025-08-03 02:01:10,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-08-03 02:01:10,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.97s ago] {'pk_1': UUID('60a2f589-dc7a-495b-939d-3b187b8d8468')}
[2025-08-03 02:01:10,013.013] base.py -> _exec_single_context line:1896 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-08-03 02:01:10,014.014] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.36s ago] {'pk_1': UUID('0c11bc40-284b-45c0-b891-dc8c048dcb0c')}
[2025-08-03 02:01:10,015.015] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-08-03 02:01:10,015.015] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.36s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'upload_file_id': UUID('60a2f589-dc7a-495b-939d-3b187b8d8468'), 'process_rule_id': UUID('0c11bc40-284b-45c0-b891-dc8c048dcb0c'), 'batch': '20250803020110598530', 'name': 'ã€aiäº§å“ç»ç†_åŒ—äº¬ 15-30Kã€‘æ®µåšæ¶µ 8å¹´.pdf', 'position': 158, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-08-03 02:01:10,016.016] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 02:01:10,017.017] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:10,018.018] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-08-03 02:01:10,018.018] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.35s ago] {'pk_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:10,051.051] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:10,051.051] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:10] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents HTTP/1.1" 200 -
[2025-08-03 02:01:14,086.086] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:14,086.086] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:14,086.086] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:14,087.087] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:14,087.087] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:14,088.088] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:14,088.088] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:14,089.089] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,089.089] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:14,090.090] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,090.090] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:14,090.090] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,090.090] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,091.091] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,092.092] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:14,093.093] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,093.093] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:14,093.093] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,093.093] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:14,094.094] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,094.094] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:14,094.094] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,094.094] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,095.095] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:14,096.096] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,096.096] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:14,096.096] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,096.096] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:14,097.097] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,097.097] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:14,097.097] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:14,097.097] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:01:14,098.098] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:14,098.098] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:14] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:15,195.195] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:15,196.196] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:15,197.197] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:15,199.199] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:15,199.199] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:15,201.201] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:15,201.201] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:15,203.203] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:15,205.205] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,205.205] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:15,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,206.206] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:15,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,207.207] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:15,208.208] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,208.208] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:15,209.209] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:15,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,211.211] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:15,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:15,212.212] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:15,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,213.213] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:15,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,214.214] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:15,215.215] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,215.215] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:15,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:15,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,217.217] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:15,217.217] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,217.217] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:15,218.218] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,219.219] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:15,220.220] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:15,221.221] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,221.221] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:15,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,222.222] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:15,223.223] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,223.223] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:01:15,226.226] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:15,226.226] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:15] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:15,825.825] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:15,826.826] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:15,826.826] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:15,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:15,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:15,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:15,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:15,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:15,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:15,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:15,834.834] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,834.834] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:15,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:15,836.836] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,836.836] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:15,837.837] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,837.837] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:15,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:15,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:15,839.839] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,839.839] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:15,840.840] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:15,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:15,843.843] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,843.843] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:15,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,844.844] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:15,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,846.846] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:15,846.846] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,846.846] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:15,847.847] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,847.847] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:15,848.848] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:15,849.849] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,849.849] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:15,849.849] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:15,849.849] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:01:15,852.852] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:15,852.852] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:15] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:16,893.893] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:16,894.894] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:16,894.894] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:16,896.896] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:16,896.896] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:16,898.898] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:16,899.899] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:16,900.900] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,900.900] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:16,901.901] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,901.901] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:16,901.901] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,901.901] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:16,902.902] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,902.902] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:16,903.903] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,903.903] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:16,904.904] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,904.904] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:16,905.905] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,905.905] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:16,906.906] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,906.906] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:16,907.907] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,907.907] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:16,908.908] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,908.908] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:16,909.909] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,909.909] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:16,910.910] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,911.911] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:16,912.912] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,912.912] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:16,912.912] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,913.913] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:16,913.913] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,913.913] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:16,914.914] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,914.914] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:16,915.915] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,915.915] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:16,916.916] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,916.916] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:16,916.916] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,916.916] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:16,917.917] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:16,917.917] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:01:16,921.921] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:16,921.921] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:16] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:17,576.576] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:17,576.576] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:17,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:17,578.578] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:17,579.579] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:17,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:17,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:17,582.582] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,583.583] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:17,583.583] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,584.584] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:17,584.584] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,584.584] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:17,585.585] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,585.585] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:17,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,586.586] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:17,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:17,588.588] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,588.588] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:17,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,590.590] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:17,591.591] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,591.591] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:17,592.592] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,592.592] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:17,593.593] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,594.594] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:17,595.595] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,595.595] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:17,596.596] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:17,596.596] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:17,597.597] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,597.597] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:17,598.598] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,598.598] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:17,599.599] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,599.599] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:17,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,600.600] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:17,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,601.601] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:17,601.601] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:17,601.601] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('3f69f722-481f-4d8f-988b-2402c89d3e5c')}
[2025-08-03 02:01:17,604.604] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:17,604.604] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:17] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-03 02:01:25,683.683] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:25,684.684] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-08-03 02:01:25,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.7s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'name': 'ã€aiäº§å“ç»ç†_åŒ—äº¬ 15-30Kã€‘æ®µåšæ¶µ 8å¹´.pdf', 'key': '2025/08/03/4e9a7d4f-3f29-4984-a079-1c04d6165401.pdf', 'size': 2898649, 'extension': 'pdf', 'mime_type': 'application/pdf', 'hash': 'fbebff9880c9c8d2be7fe675f5f568e9273c3c6d9dff5008bc341c4115722e04'}
[2025-08-03 02:01:25,686.686] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 02:01:25,688.688] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:25,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-08-03 02:01:25,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.7s ago] {'pk_1': UUID('2cdfc275-52b4-49b2-b336-45348ff42c38')}
[2025-08-03 02:01:25,691.691] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:25,692.692] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:25] "POST /upload-files/file HTTP/1.1" 200 -
[2025-08-03 02:01:30,737.737] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:30] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents HTTP/1.1" 200 -
[2025-08-03 02:01:30,743.743] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:30,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:30,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.2s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:30,747.747] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-08-03 02:01:30,747.747] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'id_1_1': '2cdfc275-52b4-49b2-b336-45348ff42c38'}
[2025-08-03 02:01:30,748.748] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-08-03 02:01:30,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'mode': 'custom', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": false}, {"id": "remove_url_and_email", "enabled": false}], "segment": {"separators": ["\\n"], "chunk_size": 500, "chunk_overlap": 50}}'}
[2025-08-03 02:01:30,749.749] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 02:01:30,751.751] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:30,751.751] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-08-03 02:01:30,751.751] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'param_1': 1}
[2025-08-03 02:01:30,752.752] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-08-03 02:01:30,753.753] base.py -> _exec_single_context line:1901 [INFO]: [cached since 117.7s ago] {'pk_1': UUID('2cdfc275-52b4-49b2-b336-45348ff42c38')}
[2025-08-03 02:01:30,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-08-03 02:01:30,754.754] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'pk_1': UUID('9728a00f-fd0e-4be6-b460-c604c1808849')}
[2025-08-03 02:01:30,755.755] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-08-03 02:01:30,755.755] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'account_id': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'dataset_id': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'upload_file_id': UUID('2cdfc275-52b4-49b2-b336-45348ff42c38'), 'process_rule_id': UUID('9728a00f-fd0e-4be6-b460-c604c1808849'), 'batch': '20250803020130559575', 'name': 'ã€aiäº§å“ç»ç†_åŒ—äº¬ 15-30Kã€‘æ®µåšæ¶µ 8å¹´.pdf', 'position': 159, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-08-03 02:01:30,756.756] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-08-03 02:01:30,757.757] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:30,758.758] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-08-03 02:01:30,758.758] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'pk_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:01:30,784.784] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:30,785.785] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:30] "POST /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents HTTP/1.1" 200 -
[2025-08-03 02:01:30,788.788] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:30] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/batch/20250803020130559575 HTTP/1.1" 200 -
[2025-08-03 02:01:30,790.790] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:30,790.790] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:30,790.790] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.3s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:30,791.791] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s
[2025-08-03 02:01:30,792.792] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'batch_1': '20250803020130559575'}
[2025-08-03 02:01:30,793.793] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:30,793.793] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:01:30,793.793] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-08-03 02:01:30,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-08-03 02:01:30,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-08-03 02:01:30,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.1s ago] {'id_1': UUID('2cdfc275-52b4-49b2-b336-45348ff42c38')}
[2025-08-03 02:01:30,795.795] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:30,795.795] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:30] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents/batch/20250803020130559575 HTTP/1.1" 200 -
[2025-08-03 02:01:33,093.093] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:33] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:01:33,093.093] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:33] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:01:33,096.096] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:33,096.096] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:33,097.097] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,097.097] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:33,097.097] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:33,097.097] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,098.098] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:33,098.098] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,098.098] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:33,099.099] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:33,099.099] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:33,099.099] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,100.100] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:33,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:33,101.101] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:33,101.101] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,102.102] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,104.104] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:01:33,104.104] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:33,104.104] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:33,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,105.105] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:33,105.105] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:33,106.106] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:33] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:01:33,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,107.107] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:33,107.107] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,107.107] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:33,107.107] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:33,108.108] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:33,108.108] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,109.109] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:33,112.112] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.6s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:33,113.113] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:33,114.114] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:33] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:01:37,198.198] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:37,199.199] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:37,199.199] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,200.200] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:37,201.201] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:37,201.201] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:37,201.201] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,201.201] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,202.202] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:37,203.203] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:37,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:37,204.204] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:37,205.205] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:37,205.205] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,205.205] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:37,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:37,206.206] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:37,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,207.207] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:01:37,208.208] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:37,209.209] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:37,209.209] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:37] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:01:37,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,210.210] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:37,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,211.211] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:37,212.212] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:37,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,213.213] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:37,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,215.215] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:37,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:37,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:37,217.217] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,217.217] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:37,218.218] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,218.218] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:37,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,219.219] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:37,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,219.219] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:37,220.220] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:37,221.221] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,221.221] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:37,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,222.222] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:37,223.223] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,223.223] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:37,224.224] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,224.224] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:37,225.225] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,225.225] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:37,226.226] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:37,226.226] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.7s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:37,228.228] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:37,229.229] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:37] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:01:38,652.652] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:38] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:01:38,653.653] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:38] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:01:38,654.654] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:38,655.655] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:01:38,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:38,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:01:38,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,657.657] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:01:38,658.658] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:38,658.658] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:01:38,659.659] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:38,661.661] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:01:38,661.661] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,661.661] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:01:38,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:38,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:01:38,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:01:38,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,664.664] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:01:38,664.664] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:01:38,665.665] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:38,667.667] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,668.668] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:38] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:01:38,668.668] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:01:38,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,679.679] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:01:38,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,679.679] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:01:38,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:01:38,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,681.681] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:01:38,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:01:38,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:01:38,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:01:38,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:01:38,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:01:38,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:01:38,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:01:38,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:01:38,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:01:38,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:01:38,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:01:38,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:01:38,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:01:38,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.2s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:01:38,690.690] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:01:38,691.691] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:01:38] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:06:16,354.354] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:06:16] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:06:16,357.357] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:06:16] "OPTIONS /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 02:06:16,367.367] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:06:16,369.369] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:06:16,369.369] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,372.372] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 02:06:16,372.372] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 02:06:16,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 02:06:16,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:06:16,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 02:06:16,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:06:16,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 02:06:16,444.444] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,444.444] base.py -> _exec_single_context line:1901 [INFO]: [cached since 409.9s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 02:06:16,453.453] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:06:16,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 02:06:16,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-08-03 02:06:16,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 02:06:16,455.455] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:06:16,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,456.456] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 02:06:16,456.456] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:06:16] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c HTTP/1.1" 200 -
[2025-08-03 02:06:16,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 02:06:16,458.458] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,458.458] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 02:06:16,458.458] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,459.459] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 02:06:16,460.460] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,460.460] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 02:06:16,460.460] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,460.460] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 02:06:16,461.461] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,461.461] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 02:06:16,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,462.462] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 02:06:16,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,462.462] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 02:06:16,463.463] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,463.463] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 02:06:16,463.463] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,463.463] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 02:06:16,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 02:06:16,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 02:06:16,474.474] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,474.474] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 02:06:16,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 02:06:16,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 02:06:16,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 02:06:16,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 02:06:16,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 02:06:16,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 02:06:16,479.479] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 02:06:16,480.480] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 02:06:16] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-08-03 15:51:57,933.933] __init__.py -> wrapped line:113 [ERROR]: Error: Directory internal/migration already exists and is not empty
[2025-08-03 16:09:45,395.395] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-08-03 16:09:45,396.396] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-08-03 16:09:45,396.396] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-03 16:09:46,932.932] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-03 16:09:46,948.948] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 682-461-187
[2025-08-03 16:09:53,746.746] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-08-03 16:09:53,746.746] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 16:09:53,747.747] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-08-03 16:09:53,747.747] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 16:09:53,747.747] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-08-03 16:09:53,747.747] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-03 16:09:53,748.748] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-03 16:09:53,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-03 16:09:53,750.750] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00010s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-03 16:09:53,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-03 16:09:53,753.753] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00013s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-03 16:09:53,756.756] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-03 16:09:53,756.756] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00010s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-03 16:09:53,758.758] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,758.758] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00010s] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-03 16:09:53,759.759] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.001418s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-03 16:09:53,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00208s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-03 16:09:53,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002773s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-03 16:09:53,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,761.761] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003438s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-03 16:09:53,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.003922s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-03 16:09:53,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004368s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-03 16:09:53,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004967s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-03 16:09:53,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005424s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-03 16:09:53,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005913s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-03 16:09:53,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,764.764] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006386s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-03 16:09:53,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,764.764] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006821s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-03 16:09:53,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007405s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-03 16:09:53,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007963s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-03 16:09:53,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008497s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-03 16:09:53,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009221s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-03 16:09:53,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009699s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-03 16:09:53,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01005s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-03 16:09:53,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01052s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-03 16:09:53,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-03 16:09:53,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01113s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-03 16:09:53,770.770] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-03 16:09:53,771.771] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [03/Aug/2025 16:09:53] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
