[2025-08-04 23:40:14,472.472] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-08-04 23:40:14,473.473] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-08-04 23:40:14,473.473] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:40:15,964.964] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-04 23:40:15,980.980] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 112-704-222
[2025-08-04 23:40:23,830.830] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-08-04 23:40:23,831.831] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-04 23:40:23,834.834] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-08-04 23:40:23,834.834] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-04 23:40:23,835.835] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-08-04 23:40:23,835.835] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-08-04 23:40:23,836.836] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-08-04 23:40:23,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-08-04 23:40:23,838.838] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'pk_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c')}
[2025-08-04 23:40:23,847.847] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-08-04 23:40:23,847.847] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3', 'param_1': 20, 'param_2': 0}
[2025-08-04 23:40:23,853.853] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-08-04 23:40:23,854.854] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00019s] {'dataset_id_1': UUID('6c5e3fd6-6307-4eb5-b017-895b25ce4a1c'), 'account_id_1': '12a2956f-b51c-4d9b-bf65-336c5acfc4f3'}
[2025-08-04 23:40:23,857.857] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,857.857] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00012s] {'coalesce_2': 0, 'document_id_1': UUID('1275b895-e66d-4258-b452-fb48a7820823')}
[2025-08-04 23:40:23,861.861] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,861.861] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004159s ago] {'coalesce_2': 0, 'document_id_1': UUID('ac6cbb93-3e36-4423-b878-a8d815c32396')}
[2025-08-04 23:40:23,862.862] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,862.862] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005465s ago] {'coalesce_2': 0, 'document_id_1': UUID('14ac7d80-0811-41cb-b102-1c945e57b645')}
[2025-08-04 23:40:23,863.863] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,863.863] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006216s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c61b108-36f4-4d63-af88-d8654a37aaa2')}
[2025-08-04 23:40:23,864.864] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,864.864] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006994s ago] {'coalesce_2': 0, 'document_id_1': UUID('75b1d38c-2c7b-4989-abc9-68edd7829931')}
[2025-08-04 23:40:23,864.864] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,865.865] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007683s ago] {'coalesce_2': 0, 'document_id_1': UUID('d98ad5a7-bbdb-445f-92c2-7da29479f168')}
[2025-08-04 23:40:23,865.865] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,865.865] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008395s ago] {'coalesce_2': 0, 'document_id_1': UUID('a1200eb8-782b-409c-908d-c52460da0111')}
[2025-08-04 23:40:23,866.866] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,866.866] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009039s ago] {'coalesce_2': 0, 'document_id_1': UUID('aeade6fc-d1cd-4cfa-a5d4-083c417739f2')}
[2025-08-04 23:40:23,866.866] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,866.866] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009626s ago] {'coalesce_2': 0, 'document_id_1': UUID('6fbe4eca-eb6c-44ef-91f8-fe5ac814c297')}
[2025-08-04 23:40:23,867.867] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,867.867] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01021s ago] {'coalesce_2': 0, 'document_id_1': UUID('f46b1169-d3a7-459c-ae7e-e61b8aac6af0')}
[2025-08-04 23:40:23,868.868] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,868.868] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0108s ago] {'coalesce_2': 0, 'document_id_1': UUID('2d6fe908-2860-431e-9607-44bbe99ae480')}
[2025-08-04 23:40:23,868.868] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,868.868] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01136s ago] {'coalesce_2': 0, 'document_id_1': UUID('9d65a8a2-b653-479e-a599-c44aa5bc997f')}
[2025-08-04 23:40:23,869.869] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,869.869] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01189s ago] {'coalesce_2': 0, 'document_id_1': UUID('bd045ae3-8a3c-4c9f-a042-480226caecc6')}
[2025-08-04 23:40:23,869.869] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,869.869] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0125s ago] {'coalesce_2': 0, 'document_id_1': UUID('76d75094-58f5-419f-824b-f2d4e2f9f0b3')}
[2025-08-04 23:40:23,870.870] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,870.870] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01311s ago] {'coalesce_2': 0, 'document_id_1': UUID('0c4a7b19-0598-4e9b-954c-813e67cc43c8')}
[2025-08-04 23:40:23,871.871] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,871.871] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01372s ago] {'coalesce_2': 0, 'document_id_1': UUID('88dff4df-74a5-49ba-b5a5-ca33dfac7e67')}
[2025-08-04 23:40:23,871.871] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,871.871] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01434s ago] {'coalesce_2': 0, 'document_id_1': UUID('d605b732-6461-49fa-af9a-231bee78610b')}
[2025-08-04 23:40:23,872.872] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,872.872] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01483s ago] {'coalesce_2': 0, 'document_id_1': UUID('9188ca01-b8fd-4d0e-809f-b124654d0a6e')}
[2025-08-04 23:40:23,872.872] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,872.872] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01534s ago] {'coalesce_2': 0, 'document_id_1': UUID('7a632de7-16df-40c4-81ea-6eaa22a61ba3')}
[2025-08-04 23:40:23,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-08-04 23:40:23,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01585s ago] {'coalesce_2': 0, 'document_id_1': UUID('16d2413d-e9ea-4118-9759-dab187054995')}
[2025-08-04 23:40:23,875.875] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-08-04 23:40:23,875.875] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [04/Aug/2025 23:40:23] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-04 23:41:58,380.380] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/document_handler.py', reloading
[2025-08-04 23:41:58,727.727] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:42:00,631.631] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-04 23:42:00,641.641] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 112-704-222
[2025-08-04 23:42:01,130.130] http.py -> _register_error_handler line:74 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask_login/utils.py", line 284, in decorated_view
    elif not current_user.is_authenticated:
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/local.py", line 318, in __get__
    obj = instance._get_current_object()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/werkzeug/local.py", line 526, in _get_current_object
    return get_name(local())
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask_login/utils.py", line 25, in <lambda>
    current_user = LocalProxy(lambda: _get_user())
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask_login/utils.py", line 370, in _get_user
    current_app.login_manager._load_user()
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask_login/login_manager.py", line 378, in _load_user
    user = self._load_user_from_request(request)
  File "/Users/icourt1/.pyenv/versions/llmops-env/lib/python3.10/site-packages/flask_login/login_manager.py", line 441, in _load_user_from_request
    user = self._request_callback(request)
  File "/Users/icourt1/Desktop/code/llmops/llmops-api/internal/middleware/middleware.py", line 34, in request_loader
    raise UnauthorizedException("该接口需要授权才能访问，请登录后尝试")
internal.exception.exception.UnauthorizedException
[2025-08-04 23:42:01,135.135] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [04/Aug/2025 23:42:01] "GET /datasets/6c5e3fd6-6307-4eb5-b017-895b25ce4a1c/documents?page_size=20&current_page=1 HTTP/1.1" 200 -
[2025-08-04 23:42:43,423.423] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/document_handler.py', reloading
[2025-08-04 23:42:43,696.696] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:42:45,406.406] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-04 23:42:45,419.419] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 112-704-222
[2025-08-04 23:53:02,289.289] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/api_tool_handler.py', reloading
[2025-08-04 23:53:02,567.567] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:53:39,241.241] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:53:41,092.092] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-04 23:53:41,101.101] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 112-704-222
[2025-08-04 23:54:02,816.816] _internal.py -> _log line:97 [INFO]:  * Detected change in '/Users/icourt1/Desktop/code/llmops/llmops-api/internal/handler/app_handler.py', reloading
[2025-08-04 23:54:03,197.197] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:55:52,257.257] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-08-04 23:55:54,256.256] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-08-04 23:55:54,268.268] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 112-704-222
